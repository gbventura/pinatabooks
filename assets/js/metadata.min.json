---
# metadata for table ajax
---
{% if site.data.theme.data-child-objects == true %}
{%- assign items = site.data[site.metadata] | where_exp: 'item','item.objectid' -%}
{% else %}
{%- assign items = site.data[site.metadata] | where_exp: 'item','item.objectid' | where_exp: 'item','item.parentid == nil' -%}
{% endif %}
{
{%- for l in site.site_languages -%}
"objects-{{ l.lang_id }}": [
{%- assign fields = site.data.config-table | where_exp: 'field', 'field.lang contains l.lang_id' | map: 'field' -%}
{%- for item in items -%}[ {% for f in fields %}{% if item[f] %}{{ item[f] | jsonify }}{% else %}"n/a"{% endif %},{% endfor %} {% if item.parentid %}"{% unless l.lang_id == site.site_languages[0]['lang_id'] %}/{{ l.lang_id }}{% endunless %}{{ '/item.html' | relative_url | append: '?id=' | append: item.parentid | append: '#' | append: item.objectid }}"{% else %}"{% unless l.lang_id == site.site_languages[0]['lang_id'] %}/{{ l.lang_id }}{% endunless %}{{ '/item.html' | relative_url | append: '?id=' | append: item.objectid }}"{% endif %} ]{% unless forloop.last %},{% endunless %}
{% endfor %}
]{% unless forloop.last %},{% endunless %}
{%- endfor -%}
}